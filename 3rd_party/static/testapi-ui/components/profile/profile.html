<!--
 Copyright (c) 2019 opnfv.

 All rights reserved. This program and the accompanying materials
 are made available under the terms of the Apache License, Version 2.0
 which accompanies this distribution, and is available at
 http://www.apache.org/licenses/LICENSE-2.0
-->

<div class="container-fluid common-main-container">
  <h3>User profile</h3>
  <div cg-busy="{promise:ctrl.authRequest,message:'Loading'}"></div>
  <div>
    <table class="table table-striped table-hover">
      <tbody>
        <tr>
          <td>User name</td>
          <td>{{auth.currentUser.fullname}}</td>
        </tr>
        <tr>
          <td>User OpenId</td>
          <td>{{auth.currentUser.openid}}</td>
        </tr>
        <tr>
          <td>Email</td>
          <td>{{auth.currentUser.email}}</td>
        </tr>
        <tr>
          <td>Role</td>
          <td>{{auth.currentUser.role}}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <br>
  <br>
  <h3>Organization Details</h3>
  <table class="table table-striped table-hover">
    <tbody>
      <tr>
        <td>Company Name</td>
        <td>
          <div class="popover-wrapper">
            <a editable-theme="bs3" onbeforesave="ctrl.changeProfileDetails(ctrl.profile, 'companyName', $data)"
               editable-text="ctrl.profile.companyName">{{ ctrl.profile.companyName || "None" }}</a>
          </div>
        </td>
      </tr>
      <tr>
        <td>Company website</td>
        <td>
          <div class="popover-wrapper">
            <a editable-theme="bs3" onbeforesave="ctrl.changeProfileDetails(ctrl.profile, 'companyWebsite', $data)"
               editable-url="ctrl.profile.companyWebsite">{{ ctrl.profile.companyWebsite || "None" }}</a>
          </div>
        </td>
      </tr>
      <tr>
        <td>Primary Contact Name</td>
        <td>
          <div class="popover-wrapper">
            <a editable-theme="bs3" onbeforesave="ctrl.changeProfileDetails(ctrl.profile, 'primaryContactName', $data)"
               editable-text="ctrl.profile.primaryContactName">{{ ctrl.profile.primaryContactName || "None" }}</a>
          </div>
        </td>
      </tr>
      <tr>
        <td>Primary Contact Business email</td>
        <td>
          <div class="popover-wrapper">
            <a editable-theme="bs3" onbeforesave="ctrl.changeProfileDetails(ctrl.profile, 'primaryBusinessEmail', $data)"
               editable-email="ctrl.profile.primaryBusinessEmail">{{ ctrl.profile.primaryBusinessEmail || "None" }}</a>
          </div>
        </td>
      </tr>
      <tr>
        <td>Primary Contact Postal Address</td>
        <td>
          <div class="popover-wrapper">
            <a editable-theme="bs3" onbeforesave="ctrl.changeProfileDetails(ctrl.profile, 'primaryPostalAddress', $data)"
               editable-text="ctrl.profile.primaryPostalAddress">{{ ctrl.profile.primaryPostalAddress || "None" }}</a>
          </div>
        </td>
      </tr>
      <tr>
        <td>Primary Contact Phone Number</td>
        <td>
          <div class="popover-wrapper">
            <a editable-theme="bs3" onbeforesave="ctrl.changeProfileDetails(ctrl.profile, 'primaryPhoneNumber', $data)"
               editable-tel="ctrl.profile.primaryPhoneNumber">{{ ctrl.profile.primaryPhoneNumber || "None" }}</a>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <div ng-show="ctrl.pubkeys">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-4">
          <h4>User Public Keys</h4>
        </div>
        <div class="col-md-2 pull-right">
          <button type="button" class="btn btn-default btn-sm" ng-click="ctrl.openImportPubKeyModal()">
            <span class="glyphicon glyphicon-plus"></span> Import Public Key
          </button>
        </div>
      </div>
    </div>

    <div>
      <table class="table table-striped table-hover">
        <tbody>
          <tr ng-repeat="pubKey in ctrl.pubkeys" ng-click="ctrl.openShowPubKeyModal(pubKey)">
            <td>{{pubKey.format}}</td>
            <td>{{pubKey.shortKey}}</td>
            <td>{{pubKey.comment}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
